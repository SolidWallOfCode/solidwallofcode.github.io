<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Command Registration &#8212; AMC Traffic Server Documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '8.0.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Testing" href="testing.en.html" />
    <link rel="prev" title="Cache Tool" href="cache-tool.en.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="testing.en.html" title="Testing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cache-tool.en.html" title="Cache Tool"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SWOC Docs</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ats-projects.en.html" >Traffic Server Projects</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="cache-tool.en.html" accesskey="U">Cache Tool</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/balcora-gate-400x400.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Command Registration</a></li>
<li><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cache-tool.en.html"
                        title="previous chapter">Cache Tool</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="testing.en.html"
                        title="next chapter">Testing</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/command-registration.en.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="command-registration">
<span id="id1"></span><h1>Command Registration<a class="headerlink" href="#command-registration" title="Permalink to this headline">¶</a></h1>
<p>Command registration is registering <em>tags</em> that correspond to actions for a command line tool to execute. There is a tree of tags so that more specific commands are done by listing multiple tags. E.g. &#8220;list&#8221; and &#8220;list stripes&#8221; are different actions and each tag controls which tags are allowed to follow. For exanmple <strong class="program">traffic_ctl</strong> with commands like:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">traffic_ctl</span> <span class="n">shutdown</span>
<span class="n">traffic_ctl</span> <span class="n">metric</span> <span class="n">set</span> <span class="n">proxy</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">http</span><span class="p">.</span><span class="n">cache</span><span class="p">.</span><span class="n">enable</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Internally this is done in <strong class="program">traffic_ctl</strong> in an ad hoc fashion where each action is done by
invoking a function and each such function must handle dispatching to any subcommand tags. This
class is an attempt to make that generic so that action functions are leafs of command line parsing.
This reduces cut and paste code along with making the tag hieararchy controlled from the top level
of the program rather than being scattered across the implementation.</p>
</div>
<div class="section" id="implementation">
<h1>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="_CPPv212CommandTable">
<span id="CommandTable"></span><em class="property">class </em><code class="descclassname"></code><code class="descname">CommandTable</code><a class="headerlink" href="#_CPPv212CommandTable" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>The root of a set of registered commands.</p>
<dl class="function">
<dt id="_CPPv2N12CommandTable12CommandTableEv">
<span id="CommandTable::CommandTable"></span><code class="descclassname"></code><code class="descname">CommandTable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12CommandTable12CommandTableEv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Construct an empty command table.</p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N12CommandTable6ActionE">
<em class="property">using </em><code class="descclassname"></code><code class="descname">Action</code> = <a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2I0ENSt8functionE" title="std::function">function</a>&lt;<a class="reference internal" href="external-types.en.html#_CPPv22ts" title="ts">ts</a>::<a class="reference internal" href="external-types.en.html#_CPPv2N2ts6ErrataE" title="ts::Errata">Errata</a><span class="sig-paren">(</span>int, char *[]<span class="sig-paren">)</span>&gt;<a class="headerlink" href="#_CPPv2N12CommandTable6ActionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A function that performs the action for a command. This action is always a leaf, any
additional arguments available are passeed to the function rather than checked for additional
commands. The first argument to the function will be the number of arguments and the second an
array of constant character pointers that are the arguments.</p>
</dd></dl>

<dl class="type">
<dt id="_CPPv2N12CommandTable13NullaryActionE">
<em class="property">using </em><code class="descclassname"></code><code class="descname">NullaryAction</code> = <a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2I0ENSt8functionE" title="std::function">function</a>&lt;<a class="reference internal" href="external-types.en.html#_CPPv22ts" title="ts">ts</a>::<a class="reference internal" href="external-types.en.html#_CPPv2N2ts6ErrataE" title="ts::Errata">Errata</a><span class="sig-paren">(</span><span class="sig-paren">)</span>&gt;<a class="headerlink" href="#_CPPv2N12CommandTable13NullaryActionE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A function that performs an action for a command. This action can be used on a non-terminal
command but can take no arguments. It will be invoked only if no more arguments remain after
processing the tag for the command.</p>
</dd></dl>

<dl class="class">
<dt id="_CPPv2N12CommandTable7CommandE">
<span id="CommandTable::Command"></span><em class="property">class </em><code class="descclassname"></code><code class="descname">Command</code><a class="headerlink" href="#_CPPv2N12CommandTable7CommandE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>An command action.</p>
<dl class="function">
<dt id="_CPPv2N12CommandTable7Command10subCommandERNSt6stringERNSt6stringE">
<span id="CommandTable::Command::subCommand__ssCR.ssCR"></span><code class="descclassname"></code><code class="descname">subCommand</code><span class="sig-paren">(</span><a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2NSt6stringE" title="std::string">string</a> <em class="property">const</em> &amp;<em>name</em>, <a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2NSt6stringE" title="std::string">string</a> <em class="property">const</em> &amp;<em>help</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12CommandTable7Command10subCommandERNSt6stringERNSt6stringE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add a subcommand to this command. The tag used is <em>name</em> along with a <em>help</em> string for diagnostics.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N12CommandTable7Command10subCommandERNSt6stringERNSt6stringE6Action">
<span id="CommandTable::Command::subCommand__ssCR.ssCR.Action"></span><code class="descclassname"></code><code class="descname">subCommand</code><span class="sig-paren">(</span><a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2NSt6stringE" title="std::string">string</a> <em class="property">const</em> &amp;<em>name</em>, <a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2NSt6stringE" title="std::string">string</a> <em class="property">const</em> &amp;<em>help</em>, <a class="reference internal" href="#_CPPv2N12CommandTable6ActionE" title="CommandTable::Action">Action</a> <em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12CommandTable7Command10subCommandERNSt6stringERNSt6stringE6Action" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add a subcommand to this command. The tag will be <em>name</em>. Help for this command
will be <em>help</em>. If the command is invoked the function <em>f</em> will be called.
This will be a leaf tag meaning that if this tag is reached no more subcommands will be
accessible and additional arguments will be passed to <em>f</em>.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N12CommandTable7Command10subCommandERNSt6stringERNSt6stringE13NullaryAction">
<span id="CommandTable::Command::subCommand__ssCR.ssCR.NullaryAction"></span><code class="descclassname"></code><code class="descname">subCommand</code><span class="sig-paren">(</span><a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2NSt6stringE" title="std::string">string</a> <em class="property">const</em> &amp;<em>name</em>, <a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2NSt6stringE" title="std::string">string</a> <em class="property">const</em> &amp;<em>help</em>, <a class="reference internal" href="#_CPPv2N12CommandTable13NullaryActionE" title="CommandTable::NullaryAction">NullaryAction</a> <em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12CommandTable7Command10subCommandERNSt6stringERNSt6stringE13NullaryAction" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Add a subcommand to this command. The tag will be <em>name</em>. Help for this command
will be <em>help</em>. If the command is invoked the function <em>f</em> will be called.
This command will only be invoked if no more arguments are available, otherwise the
additional arguments will be treated as subcommand tags.</p>
</dd></dl>

</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="testing.en.html" title="Testing"
             >next</a> |</li>
        <li class="right" >
          <a href="cache-tool.en.html" title="Cache Tool"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SWOC Docs</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ats-projects.en.html" >Traffic Server Projects</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="cache-tool.en.html" >Cache Tool</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, amc@apache.org.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.5.
    </div>
  </body>
</html>