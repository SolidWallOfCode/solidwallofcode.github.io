<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="915.4506px" preserveAspectRatio="none" style="width:710px;height:915px;" version="1.1" viewBox="0 0 710 915" width="710.7296px" zoomAndPan="magnify"><defs><filter height="300%" id="f14axlslfuqoe8" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.5450643776824033"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="3.0901287553648067" dy="3.0901287553648067" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="57.3484" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="114.3348" x="182.3176" y="81.1159"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="182.3176" x2="296.6524" y1="101.4311" y2="101.4311"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="93.4764" x="192.7468" y="95.0177">ReadRequestHdr</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="44.0343" x="186.1803" y="113.8987">Check for</text><text fill="#000000" font-family="monospace" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="37.8541" x="233.3047" y="113.8987">CONNECT</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="186.1803" x2="285.0644" y1="119.9477" y2="119.9477"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="186.1803" x2="285.0644" y1="121.4928" y2="121.4928"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="98.8841" x="186.1803" y="132.4153">Find Peer for Service.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="57.3484" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="148.3262" x="111.2446" y="197.7682"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="111.2446" x2="259.5708" y1="218.0834" y2="218.0834"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="49.4421" x="160.6867" y="211.67">Intercept</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="132.8755" x="115.1073" y="230.5511">Intercept Client Transaction.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="115.1073" x2="247.9828" y1="236.6001" y2="236.6001"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="115.1073" x2="247.9828" y1="238.1451" y2="238.1451"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="113.5622" x="115.1073" y="249.0677">Initialize Bridge Context.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="94.3817" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="202.4034" x="4.6352" y="435.7082"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="4.6352" x2="207.0386" y1="456.0233" y2="456.0233"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="37.8541" x="86.9099" y="449.61">Accept</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="37.8541" x="8.4979" y="468.491">Initialize</text><text fill="#000000" font-family="monospace" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="27.0386" x="49.4421" y="468.491">VConn</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="23.9485" x="79.5708" y="468.491">data.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="8.4979" x2="195.4506" y1="474.54" y2="474.54"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="8.4979" x2="195.4506" y1="476.085" y2="476.085"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="127.4678" x="8.4979" y="487.0076">Create internal transaction.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="8.4979" x2="195.4506" y1="493.0566" y2="493.0566"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="8.4979" x2="195.4506" y1="494.6017" y2="494.6017"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="118.1974" x="8.4979" y="505.5242">Set up Client side tunnel.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="8.4979" x2="195.4506" y1="511.5732" y2="511.5732"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="8.4979" x2="195.4506" y1="513.1183" y2="513.1183"/><text fill="#000000" font-family="monospace" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="37.8541" x="8.4979" y="524.0409">CONNECT</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="146.0086" x="49.4421" y="524.0409">to Peer via internal transaction.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="38.8318" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="66.4378" x="341.4592" y="720"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="341.4592" x2="407.897" y1="740.3152" y2="740.3152"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="37.8541" x="355.7511" y="733.9018">Tunnel</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="50.9871" x="345.3219" y="752.7828">Move data.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="68.1398" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="207.0386" x="152.1888" y="838.97"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="152.1888" x2="359.2275" y1="859.2851" y2="859.2851"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="69.5279" x="220.9442" y="852.8718">Flow To Peer</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="101.9742" x="156.0515" y="871.7528">Move data from Client</text><text fill="#000000" font-family="monospace" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="86.5236" x="261.1159" y="871.7528">TSIOBufferReader</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="32.4464" x="156.0515" y="882.5441">to Peer</text><text fill="#000000" font-family="monospace" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="54.0773" x="191.588" y="882.5441">TSIOBuffer</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="3.0901" x="245.6652" y="882.5441">.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="156.0515" x2="347.6395" y1="888.5931" y2="888.5931"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="156.0515" x2="347.6395" y1="890.1381" y2="890.1381"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="66.4378" x="156.0515" y="901.0607">Reenable VIOs</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="68.1398" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="200.8584" x="427.9828" y="838.97"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="427.9828" x2="628.8412" y1="859.2851" y2="859.2851"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="76.4807" x="490.1717" y="852.8718">Flow To Client</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="95.794" x="431.8455" y="871.7528">Move data from Peer</text><text fill="#000000" font-family="monospace" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="86.5236" x="530.7296" y="871.7528">TSIOBufferReader</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="38.6266" x="431.8455" y="882.5441">to Client</text><text fill="#000000" font-family="monospace" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="54.0773" x="473.5622" y="882.5441">TSIOBuffer</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="3.0901" x="527.6395" y="882.5441">.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="431.8455" x2="617.2532" y1="888.5931" y2="888.5931"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="431.8455" x2="617.2532" y1="890.1381" y2="890.1381"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="66.4378" x="431.8455" y="901.0607">Reenable VIOs</text><ellipse cx="239.485" cy="13.9056" fill="#000000" filter="url(#f14axlslfuqoe8)" rx="7.7253" ry="7.7253" style="stroke: none; stroke-width: 0.7725321888412017;"/><ellipse cx="319.0558" cy="226.3519" fill="none" filter="url(#f14axlslfuqoe8)" rx="7.7253" ry="7.7253" style="stroke: #000000; stroke-width: 0.7725321888412017;"/><ellipse cx="319.4421" cy="226.7382" fill="#000000" rx="4.6352" ry="4.6352" style="stroke: none; stroke-width: 0.7725321888412017;"/><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="57.3484" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="121.2876" x="547.3391" y="710.7296"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="547.3391" x2="668.6266" y1="731.0448" y2="731.0448"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="54.0773" x="580.9442" y="724.6314">Shutdown</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="86.5236" x="551.2017" y="743.5124">Close Client VConn</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="551.2017" x2="657.0386" y1="749.5614" y2="749.5614"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="551.2017" x2="657.0386" y1="751.1065" y2="751.1065"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="105.8369" x="551.2017" y="762.0291">Close Upstream VConn</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="337.0534" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="281.2017" x="234.0773" y="314.4206"/><rect fill="#FFFFFF" height="312.103" rx="9.6567" ry="9.6567" style="stroke: #FFFFFF; stroke-width: 0.7725321888412017;" width="276.5665" x="236.3948" y="337.0534"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="234.0773" x2="515.279" y1="334.7358" y2="334.7358"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="129.7854" x="309.7854" y="328.3224">Wait For Peer Response</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="38.8318" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="120.515" x="311.7167" y="388.0405"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="311.7167" x2="432.2318" y1="408.3557" y2="408.3557"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="105.0644" x="319.4421" y="401.9423">WaitForStatusCode</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="100.4292" x="315.5794" y="420.8233">Parse for status code.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="38.8318" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="132.103" x="261.8884" y="454.4783"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="261.8884" x2="393.9914" y1="474.7935" y2="474.7935"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="116.6524" x="269.6137" y="468.3801">WaitForResponseEnd</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="116.6524" x="265.7511" y="487.2611">Parse for double newline.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="49.6231" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="103.5193" x="385.8798" y="534.0491"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="385.8798" x2="489.3991" y1="554.3643" y2="554.3643"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="55.6223" x="409.8283" y="547.9509">BadStatus</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="64.8927" x="389.7425" y="566.8319">Set error data</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="88.0687" x="389.7425" y="577.6232">in Client Response.</text><rect fill="#FEFECE" filter="url(#f14axlslfuqoe8)" height="75.8651" rx="9.6567" ry="9.6567" style="stroke: #A80036; stroke-width: 1.1587982832618025;" width="129.0129" x="242.5751" y="520.916"/><line style="stroke: #A80036; stroke-width: 1.1587982832618025;" x1="242.5751" x2="371.588" y1="541.2312" y2="541.2312"/><text fill="#000000" font-family="sans-serif" font-size="10.8155" lengthAdjust="spacingAndGlyphs" textLength="59.485" x="277.3391" y="534.8178">PeerReady</text><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="113.5622" x="246.4378" y="553.6989">Update Client Response.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="246.4378" x2="360" y1="559.7479" y2="559.7479"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="246.4378" x2="360" y1="561.2929" y2="561.2929"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="91.1588" x="246.4378" y="572.2155">Set up peer tunnel.</text><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="246.4378" x2="360" y1="578.2645" y2="578.2645"/><line style="stroke: #A80036; stroke-width: 0.7725321888412017;" x1="246.4378" x2="360" y1="579.8095" y2="579.8095"/><text fill="#000000" font-family="sans-serif" font-size="9.2704" lengthAdjust="spacingAndGlyphs" textLength="75.7082" x="246.4378" y="590.7321">Start Tunneling.</text><ellipse cx="371.9742" cy="352.504" fill="#000000" filter="url(#f14axlslfuqoe8)" rx="7.7253" ry="7.7253" style="stroke: none; stroke-width: 0.7725321888412017;"/><ellipse cx="371.9742" cy="632.1607" fill="none" filter="url(#f14axlslfuqoe8)" rx="7.7253" ry="7.7253" style="stroke: #000000; stroke-width: 0.7725321888412017;"/><ellipse cx="372.3605" cy="632.5469" fill="#000000" rx="4.6352" ry="4.6352" style="stroke: none; stroke-width: 0.7725321888412017;"/><!--link *start*WaitForPeerResponse to WaitForStatusCode--><path d="M371.9742,360.3627 C371.9742,366.5231 371.9742,375.432 371.9742,383.8401 " fill="none" id="*start*WaitForPeerResponse-WaitForStatusCode" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="371.9742,387.9133,375.0644,380.9605,371.9742,384.0506,368.8841,380.9605,371.9742,387.9133" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link WaitForStatusCode to WaitForResponseEnd--><path d="M359.0007,426.928 C353.9839,434.4971 348.2089,443.2103 343.0099,451.0546 " fill="none" id="WaitForStatusCode-WaitForResponseEnd" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="340.8208,454.3573,347.2377,450.269,342.9548,451.1376,342.0862,446.8547,340.8208,454.3573" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link WaitForStatusCode to BadStatus--><path d="M384.9985,426.8045 C390.2371,435.1154 396.0832,445.0571 400.5579,454.4783 C412.3166,479.2351 422.4828,508.7773 429.1812,530.0888 " fill="none" id="WaitForStatusCode-BadStatus" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="430.3912,533.9693,431.2715,526.4118,429.2413,530.2817,425.3714,528.2516,430.3912,533.9693" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link BadStatus to *end*WaitForPeerResponse--><path d="M415.4082,583.6168 C403.2404,597.2162 388.8963,613.2477 380.1204,623.0562 " fill="none" id="BadStatus-*end*WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="377.3688,626.1314,384.3078,623.0104,379.9444,623.2528,379.702,618.8894,377.3688,626.1314" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link WaitForResponseEnd to PeerReady--><path d="M323.1546,493.2874 C321.4231,500.3413 319.3948,508.605 317.3733,516.8407 " fill="none" id="WaitForResponseEnd-PeerReady" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="316.4461,520.6183,321.1047,514.6027,317.367,516.867,315.1026,513.1293,316.4461,520.6183" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link PeerReady to *end*WaitForPeerResponse--><path d="M340.6684,596.7552 C349.3857,606.6141 357.9931,616.3487 363.9696,623.1078 " fill="none" id="PeerReady-*end*WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="366.681,626.1742,364.3906,618.9186,364.1224,623.2805,359.7606,623.0124,366.681,626.1742" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link *start to ReadRequestHdr--><path d="M239.485,21.7448 C239.485,33.7677 239.485,57.4441 239.485,77.2056 " fill="none" id="*start-ReadRequestHdr" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="239.485,81.1011,242.5751,74.1483,239.485,77.2385,236.3948,74.1483,239.485,81.1011" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="monospace" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="43.2618" x="240.2575" y="54.9015">CONNECT</text><text fill="#000000" font-family="sans-serif" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="37.0815" x="286.6094" y="54.9015">Service</text><!--link ReadRequestHdr to *end--><path d="M259.1542,138.535 C276.5123,163.9824 300.8033,199.5933 312.3929,216.584 " fill="none" id="ReadRequestHdr-*end" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="314.6662,219.9167,313.301,212.4316,312.4895,216.7257,308.1954,215.9142,314.6662,219.9167" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="sans-serif" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="67.9828" x="282.7468" y="171.5538">Not matched.</text><!--link ReadRequestHdr to Intercept--><path d="M226.1175,138.535 C218.3212,155.353 208.4668,176.6101 200.4064,193.9977 " fill="none" id="ReadRequestHdr-Intercept" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="198.715,197.6463,204.4428,192.638,200.3396,194.1419,198.8358,190.0387,198.715,197.6463" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link Intercept to Accept--><path d="M176.5116,255.0269 C163.2443,297.7912 138.0772,378.9127 121.6338,431.9144 " fill="none" id="Intercept-Accept" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="120.4653,435.681,125.477,429.9563,121.6099,431.9919,119.5743,428.1248,120.4653,435.681" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="monospace" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="117.4249" x="169.1845" y="288.2062">TS_EVENT_NET_ACCEPT</text><!--link Accept to WaitForPeerResponse--><path d="M207.1775,482.8326 C214.7922,482.8326 222.4069,482.8326 230.0217,482.8326 " fill="none" id="Accept-WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="234.0037,482.8326,227.0509,479.7425,230.141,482.8326,227.0509,485.9227,234.0037,482.8326" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link WaitForPeerResponse to WaitForPeerResponse--><path d="M515.3154,451.1852 C531.6747,457.0259 542.3176,467.5751 542.3176,482.8326 C542.3176,496.8981 533.2727,506.9622 519.0426,513.0249 " fill="none" id="WaitForPeerResponse-WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="515.3154,514.48,522.9159,514.8299,518.9136,513.0752,520.6683,509.0729,515.3154,514.48" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="monospace" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="154.5064" x="546.9528" y="486.3607">TS_EVENT_VCONN_READ_READY</text><!--link WaitForPeerResponse to Tunnel--><path d="M374.6781,651.406 C374.6781,676.7381 374.6781,699.7325 374.6781,715.8451 " fill="none" id="WaitForPeerResponse-Tunnel" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="374.6781,719.7904,377.7682,712.8376,374.6781,715.9278,371.588,712.8376,374.6781,719.7904" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="sans-serif" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="36.309" x="375.4506" y="684.5152">200 OK</text><!--link *end to WaitForPeerResponse--><path d="M321.5721,237.9547 C324.8702,253.1626 331.0684,281.7435 338.0995,314.1647 " fill="none" id="*end-WaitForPeerResponse" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="320.7204,234.0279,319.1742,241.4777,321.5391,237.8028,325.214,240.1678,320.7204,234.0279" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="sans-serif" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="100.4292" x="332.9614" y="288.2062">Peer connect failure</text><!--link Tunnel to FlowToClient--><path d="M375.1539,758.7687 C376.5503,775.6769 381.0455,799.8888 394.7639,815.794 C403.0542,825.4058 413.2459,833.4474 424.2717,840.1648 " fill="none" id="Tunnel-FlowToClient" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="427.7192,842.2073,423.3125,836.0047,424.396,840.2384,420.1623,841.3219,427.7192,842.2073" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="monospace" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="154.5064" x="395.5365" y="801.1676">TS_EVENT_VCONN_READ_READY</text><text fill="#000000" font-family="sans-serif" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="43.2618" x="451.1588" y="812.8581">Peer VIO</text><!--link FlowToClient to Tunnel--><path d="M552.16,838.864 C559.989,823.1407 564.3319,804.9364 553.9056,791.073 C536.8645,768.4142 459.3043,752.5391 411.9733,744.7669 " fill="none" id="FlowToClient-Tunnel" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="408.0553,744.1307,414.4229,748.2953,411.868,744.7498,415.4135,742.1949,408.0553,744.1307" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link Tunnel to FlowToPeer--><path d="M341.4043,742.8235 C288.9534,749.1194 190.8469,764.2443 169.9571,791.073 C157.456,807.128 167.3937,822.9934 184.3056,836.422 " fill="none" id="Tunnel-FlowToPeer" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="187.5407,838.9006,183.9008,832.2192,184.4745,836.5515,180.1422,837.1252,187.5407,838.9006" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="monospace" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="160.6867" x="170.7296" y="801.1676">TS_EVENT_VCONN_READY_READY</text><text fill="#000000" font-family="sans-serif" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="50.2146" x="225.9657" y="812.8581">Client VIO</text><!--link FlowToPeer to Tunnel--><path d="M310.4346,838.9603 C319.3732,831.9724 328.0573,824.1662 335.279,815.794 C348.9167,799.9833 359.4086,778.6344 366.1237,762.5102 " fill="none" id="FlowToPeer-Tunnel" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="367.6656,758.7385,362.1743,764.0051,366.204,762.314,367.8951,766.3436,367.6656,758.7385" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><!--link Tunnel to Shutdown--><path d="M408.105,739.3133 C443.2681,739.3133 499.4828,739.3133 543.3528,739.3133 " fill="none" id="Tunnel-Shutdown" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><polygon fill="#A80036" points="547.2902,739.3133,540.3374,736.2232,543.4276,739.3133,540.3374,742.4034,547.2902,739.3133" style="stroke: #A80036; stroke-width: 0.7725321888412017;"/><text fill="#000000" font-family="monospace" font-size="10.0429" lengthAdjust="spacingAndGlyphs" textLength="111.2446" x="421.9957" y="733.9573">TS_EVENT_VCONN_EOS</text><!--
@startuml

scale max 720 width

ReadRequestHdr : Check for ""CONNECT""
ReadRequestHdr : =====
ReadRequestHdr : Find Peer for Service.

Intercept : Intercept Client Transaction.
Intercept : =====
Intercept : Initialize Bridge Context.

Accept : Initialize ""VConn"" data.
Accept : =====
Accept : Create internal transaction.
Accept : =====
Accept : Set up Client side tunnel.
Accept : =====
Accept : ""CONNECT"" to Peer via internal transaction.

Tunnel : Move data.

state "Flow To Peer" as FlowToPeer
FlowToPeer : Move data from Client ""TSIOBufferReader""\nto Peer ""TSIOBuffer"".
FlowToPeer : =====
FlowToPeer : Reenable VIOs

state "Flow To Client" as FlowToClient
FlowToClient : Move data from Peer ""TSIOBufferReader""\nto Client ""TSIOBuffer"".
FlowToClient : =====
FlowToClient : Reenable VIOs

state "Wait For Peer Response" as WaitForPeerResponse {
  WaitForStatusCode : Parse for status code.

  WaitForResponseEnd : Parse for double newline.

  BadStatus : Set error data\nin Client Response.

  PeerReady : Update Client Response.
  PeerReady : =====
  PeerReady : Set up peer tunnel.
  PeerReady : =====
  PeerReady : Start Tunneling.

  [*] - -> WaitForStatusCode
  WaitForStatusCode - -> WaitForResponseEnd
  WaitForStatusCode - -> BadStatus
  BadStatus - -> [*]
  WaitForResponseEnd - -> PeerReady
  PeerReady - -> [*]
}

[*] - -> ReadRequestHdr : ""CONNECT"" Service
ReadRequestHdr - -> [*] : Not matched.
ReadRequestHdr - -> Intercept
Intercept - -> Accept : ""TS_EVENT_NET_ACCEPT""
Accept -r-> WaitForPeerResponse
WaitForPeerResponse - -> WaitForPeerResponse : ""TS_EVENT_VCONN_READ_READY""
WaitForPeerResponse - -> Tunnel : 200 OK
WaitForPeerResponse -u-> [*] : Peer connect failure

Tunnel - -> FlowToClient : ""TS_EVENT_VCONN_READ_READY""\nPeer VIO
FlowToClient - -> Tunnel
Tunnel - -> FlowToPeer : ""TS_EVENT_VCONN_READY_READY""\nClient VIO
FlowToPeer - -> Tunnel

Tunnel -right-> Shutdown : ""TS_EVENT_VCONN_EOS""

Shutdown : Close Client VConn
Shutdown : =====
Shutdown : Close Upstream VConn

@enduml

PlantUML version 1.2017.18(Fri Oct 06 11:56:32 CDT 2017)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_151-b12
Operating System: Linux
OS Version: 4.13.13-200.fc26.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>