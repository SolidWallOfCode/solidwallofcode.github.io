<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="437px" preserveAspectRatio="none" style="width:897px;height:437px;" version="1.1" viewBox="0 0 897 437" width="897px" zoomAndPan="magnify"><defs><filter height="300%" id="f1dlmpbo1drqi1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster HttpSM--><polygon fill="#FFFFFF" filter="url(#f1dlmpbo1drqi1)" points="14,16,80,16,87,38.2969,765,38.2969,765,205,14,205,14,16" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="14" x2="87" y1="38.2969" y2="38.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="18" y="30.9951">HttpSM</text><!--cluster Strategy--><polygon fill="#FFFFFF" filter="url(#f1dlmpbo1drqi1)" points="305,239,380,239,387,261.2969,713,261.2969,713,425,305,425,305,239" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="305" x2="387" y1="261.2969" y2="261.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="69" x="309" y="253.9951">Strategy</text><ellipse cx="103" cy="55" fill="#000000" filter="url(#f1dlmpbo1drqi1)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="22.5" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="141" x="32.5" y="184.1387">Determine strategy tag</text><polygon fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" points="678,43,690,55,678,67,666,55,678,43" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#000000" filter="url(#f1dlmpbo1drqi1)" height="8" style="stroke: none; stroke-width: 1.0;" width="80" x="499" y="176"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="158" x="599" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="138" x="609" y="184.1387">Read Response Header</text><polygon fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" points="401,43,413,55,401,67,389,55,401,43" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="323" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="136" x="333" y="184.1387">Forward to User Agent</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="99" x="203.5" y="163"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="79" x="213.5" y="184.1387">Drain session</text><ellipse cx="747" cy="55" fill="none" filter="url(#f1dlmpbo1drqi1)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="747.5" cy="55.5" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="182" x="313" y="383"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="162" x="323" y="404.1387">Create strategizer instance</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="313" y="266"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="112" x="323" y="287.1387">Connect upstream</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="163" x="528.5" y="383"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="143" x="538.5" y="404.1387">Event: SESSION_READY</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="147" x="465.5" y="266"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="127" x="475.5" y="287.1387">Compute next action</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="72" x="633" y="266"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="52" x="643" y="287.1387">Destruct</text><!--link start to Determine strategy tag--><path d="M103,65.2293 C103,85.3455 103,130.463 103,157.7549 " fill="none" id="start-Determine strategy tag" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="103,162.963,107,153.963,103,157.963,99,153.963,103,162.963" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Determine strategy tag to Create strategizer instance--><path d="M126.619,197.263 C181.5676,237.4248 317.7507,336.9606 376.4039,379.8301 " fill="none" id="Determine strategy tag-Create strategizer instance" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="380.4908,382.8172,375.5849,374.2772,376.454,379.8668,370.8644,380.736,380.4908,382.8172" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Connect upstream to Create strategizer instance--><path d="M383.6845,304.9237 C388.517,327.5394 395.9518,362.3346 400.3604,382.9667 " fill="none" id="Connect upstream-Create strategizer instance" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="382.6352,300.0128,380.6042,309.65,383.68,304.9024,388.4276,307.9782,382.6352,300.0128" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Connect upstream to Event: SESSION_READY--><path d="M412.5894,300.0128 C454.9312,321.4587 527.5317,358.2303 571.901,380.7031 " fill="none" id="Connect upstream-Event: SESSION_READY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="576.3701,382.9667,570.1486,375.3317,571.9096,380.7075,566.5339,382.4685,576.3701,382.9667" style="stroke: #A80036; stroke-width: 1.0;"/><!--link #14 to Event: SESSION_READY--><path d="M692.1009,59.4858 C736.7362,74.6589 872,128.5169 872,224 C872,224 872,224 872,341.5 C872,360.2299 768.6945,378.5039 691.8207,389.5095 " fill="none" id="#14-Event: SESSION_READY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="687.357,57.9038,694.629,64.5459,692.1001,59.4858,697.1602,56.9569,687.357,57.9038" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="74" x="583.6408" y="78.1184">send request</text><!--link #14 to RESULT--><path d="M671.6663,60.6958 C649.1741,80.9226 573.1238,149.3132 547.5049,172.3517 " fill="none" id="#14-RESULT" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="543.5852,175.8766,552.9519,172.8328,547.303,172.5332,547.6025,166.8843,543.5852,175.8766" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="51" x="619" y="119.2104">net error</text><!--link #14 to Read Response Header--><path d="M678,67.4425 C678,88.5155 678,131.4992 678,157.8252 " fill="none" id="#14-Read Response Header" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="678,162.8569,682,153.8569,678,157.8569,674,153.8569,678,162.8569" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="44" x="679" y="119.2104">success</text><!--link Read Response Header to RESULT--><path d="M598.8665,180 C594.0474,180 589.2282,180 584.409,180 " fill="none" id="Read Response Header-RESULT" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="579.1797,180,588.1797,184,584.1797,180,588.1797,176,579.1797,180" style="stroke: #A80036; stroke-width: 1.0;"/><!--link RESULT to Compute next action--><path d="M539,184.4258 C539,197.3673 539,235.7944 539,260.6714 " fill="none" id="RESULT-Compute next action" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="539,265.7601,543,256.7601,539,260.7601,535,256.7601,539,265.7601" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Compute next action to #25--><path d="M567.3307,265.879 C583.2412,256.8542 603.7203,246.1951 623,239 C684.6092,216.0076 726.1917,256.5657 767,205 C778.5839,190.3625 772.5574,180.8202 767,163 C758.1544,134.6359 754.1225,123.8627 729,108 C676.0802,74.5856 477.2011,59.7374 417.8333,55.9889 " fill="none" id="Compute next action-#25" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="412.5331,55.6605,421.2684,60.2096,417.5235,55.9698,421.7633,52.2249,412.5331,55.6605" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="43" x="420.9978" y="67.6808">ACTION</text><!--link #25 to Forward to User Agent--><path d="M401,67.4425 C401,88.5155 401,131.4992 401,157.8252 " fill="none" id="#25-Forward to User Agent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="401,162.8569,405,153.8569,401,157.8569,397,153.8569,401,162.8569" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="402" y="119.2104">DONE</text><!--link #25 to Drain session--><path d="M394.2562,60.6958 C373.8786,77.9066 312.2136,129.9885 277.4724,159.3308 " fill="none" id="#25-Drain session" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="273.3737,162.7925,282.8305,160.0413,277.1936,159.5663,277.6686,153.9294,273.3737,162.7925" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="37" x="339" y="119.2104">RETRY</text><!--link Drain session to Connect upstream--><path d="M273.8063,197.0084 C295.8754,215.0489 330.7289,243.5403 354.2069,262.7327 " fill="none" id="Drain session-Connect upstream" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="358.1628,265.9664,353.7264,257.1733,354.2917,262.8018,348.6631,263.3671,358.1628,265.9664" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="313" y="228.2104">finish()</text><!--link Forward to User Agent to Destruct--><path d="M460.1063,197.0397 C469.7503,199.7485 479.644,202.4846 489,205 C548.3357,220.9526 569.2517,209.2287 623,239 C633.4679,244.7982 643.3102,253.5633 651.1834,261.7482 " fill="none" id="Forward to User Agent-Destruct" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="654.8843,265.704,651.6566,256.3991,651.4684,262.0528,645.8146,261.8646,654.8843,265.704" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="38" x="605" y="228.2104">finish()</text><!--link Destruct to end--><path d="M705.2325,278.0697 C735.6724,272.0597 778.2194,258.9862 804,231 C849.1687,181.967 885.2269,140.9045 846,87 C835.9782,73.2283 786.9971,62.3813 761.8951,57.6235 " fill="none" id="Destruct-end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="756.9237,56.7018,765.0436,62.2756,761.8399,57.6134,766.5021,54.4096,756.9237,56.7018" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
partition HttpSM {
   (*) - -> "Determine strategy tag"
}

partition Strategy {
   "Determine strategy tag" - -> "Create strategizer instance"
   "Create strategizer instance" -u-> "Connect upstream"
   "Connect upstream" - -> "Event: SESSION_READY"
}

partition HttpSM {
   "Event: SESSION_READY" -l->  if "send request" then
      - ->[net error] ===RESULT===
   else
      - ->[success] "Read Response Header"
      -> ===RESULT===
   endif
}

partition Strategy {
   - -> "Compute next action"
}

partition HttpSM {
   if "ACTION" then
      - ->[DONE] "Forward to User Agent"
   else
      - ->[RETRY] "Drain session"
   endif
}

partition Strategy {
   "Drain session" - ->[finish()] "Connect upstream"
   "Forward to User Agent" -down->[finish()] "Destruct"
}

partition HttpSM {
   "Destruct" - -> (*)
}

@enduml

PlantUML version 1.2018.01(Sun Jan 28 12:08:22 CST 2018)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_181-b15
Operating System: Linux
OS Version: 4.18.12-200.fc28.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>