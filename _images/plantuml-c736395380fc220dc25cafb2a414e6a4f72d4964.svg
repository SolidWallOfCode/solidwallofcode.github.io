<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="340px" preserveAspectRatio="none" style="width:1283px;height:340px;" version="1.1" viewBox="0 0 1283 340" width="1283px" zoomAndPan="magnify"><defs><filter height="300%" id="f1dlmpbo1drqi1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[a4989be5c021e552817400c70debef8b]
cluster HttpSM--><polygon fill="#FFFFFF" filter="url(#f1dlmpbo1drqi1)" points="14,16,76,16,83,38.2969,791,38.2969,791,253,14,253,14,16" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="14" x2="83" y1="38.2969" y2="38.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="18" y="30.9951">HttpSM</text><!--MD5=[60863c9b1bfc01c3f13ecc9386826f40]
cluster Strategy--><polygon fill="#FFFFFF" filter="url(#f1dlmpbo1drqi1)" points="799,96,872,96,879,118.2969,1215,118.2969,1215,328,799,328,799,96" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="799" x2="879" y1="118.2969" y2="118.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="803" y="110.9951">Strategy</text><ellipse cx="105" cy="55" fill="#000000" filter="url(#f1dlmpbo1drqi1)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="166" x="22" y="211"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="146" x="32" y="232.1387">Determine strategy tag</text><polygon fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" points="436,43,448,55,436,67,424,55,436,43" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#000000" filter="url(#f1dlmpbo1drqi1)" height="8" style="stroke: none; stroke-width: 1.0;" width="80" x="396" y="224"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="168" x="208" y="211"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="148" x="218" y="232.1387">Read Response Header</text><polygon fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" points="730,43,742,55,730,67,718,55,730,43" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="161" x="496.5" y="211"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="141" x="506.5" y="232.1387">Forward to User Agent</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="677.5" y="211"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="85" x="687.5" y="232.1387">Drain session</text><ellipse cx="773" cy="55" fill="none" filter="url(#f1dlmpbo1drqi1)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="773.5" cy="55.5" fill="#000000" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="191" x="831.5" y="286"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="171" x="841.5" y="307.1387">Create strategizer instance</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="136" x="1071" y="123"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="116" x="1081" y="144.1387">Connect upstream</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="162" x="1045" y="286"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="142" x="1055" y="307.1387">Event: SESSION_READY</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="807" y="123"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="130" x="817" y="144.1387">Compute next action</text><rect fill="#FEFECE" filter="url(#f1dlmpbo1drqi1)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="74" x="977" y="123"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="54" x="987" y="144.1387">Destruct</text><!--MD5=[af8b7a5172296bcaffa26b7c8734df5e]
link start to Determine strategy tag--><path d="M105,65.049 C105,92.1988 105,167.5281 105,205.5023 " fill="none" id="start-&gt;Determine strategy tag" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="105,210.8238,109,201.8238,105,205.8238,101,201.8238,105,210.8238" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[67ddc500689f20ccfc87a958dbe352dd]
link Determine strategy tag to Create strategizer instance--><path d="M161.6676,245.1054 C173.5759,248.1709 186.1269,251.0163 198,253 C315.9407,272.7048 655.4958,290.5023 826.3202,298.5162 " fill="none" id="Determine strategy tag-&gt;Create strategizer instance" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="831.3246,298.7504,822.5215,294.3338,826.3301,298.5165,822.1474,302.3251,831.3246,298.7504" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[28827781ba7e287bd5dccd1128bda21e]
reverse link Connect upstream to Create strategizer instance--><path d="M1112.5109,160.3666 C1070.3383,192.7918 988.6849,255.5725 949.3065,285.8492 " fill="none" id="Connect upstream&lt;-Create strategizer instance" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1116.713,157.1358,1107.14,159.4503,1112.7491,160.1834,1112.0161,165.7925,1116.713,157.1358" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[1fbefae93a54d5a190dd5f09f37ae4de]
link Connect upstream to Event: SESSION_READY--><path d="M1137.6333,157.1358 C1135.2696,186.7739 1130.4191,247.5913 1127.7897,280.5601 " fill="none" id="Connect upstream-&gt;Event: SESSION_READY" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1127.3875,285.6032,1132.0905,276.9498,1127.7851,280.619,1124.1158,276.3136,1127.3875,285.6032" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[a6f2f20d2dd5bc079bea1b596a2a2122]
link Event: SESSION_READY to #14--><path d="M1144.9165,285.7938 C1185.1017,247.2602 1271.0427,152.9542 1217,96 C1210.1788,88.8113 565.7381,60.6132 452.7976,55.7243 " fill="none" id="Event: SESSION_READY-&gt;#14" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="447.5377,55.4969,456.3564,59.8822,452.533,55.713,456.7022,51.8897,447.5377,55.4969" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="76" x="456.052" y="66.8932">send request</text><!--MD5=[2860463b8886697b931262e8a415ce25]
link #14 to RESULT--><path d="M436,67.165 C436,99.9075 436,189.3957 436,218.6266 " fill="none" id="#14-&gt;RESULT" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="436,223.9074,440,214.9074,436,218.9074,432,214.9074,436,223.9074" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="51" x="437" y="144.2104">net error</text><!--MD5=[382f672dc5c994d4e292183bafd3da5e]
link #14 to Read Response Header--><path d="M428.4071,59.634 C417.3628,66.6108 396.5954,80.6409 382,96 C348.9474,130.7821 319.4679,178.8325 303.8256,206.3362 " fill="none" id="#14-&gt;Read Response Header" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="301.2517,210.8967,309.1588,205.025,303.7093,206.5424,302.1919,201.0928,301.2517,210.8967" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="47" x="383" y="144.2104">success</text><!--MD5=[a7a4f6a9cb45bf00d1b274fdccb6765d]
link Read Response Header to RESULT--><path d="M376.0938,228 C380.9056,228 385.7174,228 390.5292,228 " fill="none" id="Read Response Header-&gt;RESULT" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="395.7505,228,386.7505,224,390.7505,228,386.7505,232,395.7505,228" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[b975c04466f95df5c90b8c7c87c538f2]
link RESULT to Compute next action--><path d="M446.8043,223.8766 C457.0333,220.098 472.8836,214.5651 487,211 C622.1705,176.8622 658.9409,182.5193 796,157 C797.9077,156.6448 799.8387,156.2828 801.7859,155.9156 " fill="none" id="RESULT-&gt;Compute next action" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="806.9735,154.9324,797.386,152.6785,802.061,155.8636,798.8759,160.5385,806.9735,154.9324" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[d55650b024cac47e93b9585c9e952ced]
link Compute next action to #24--><path d="M851.3791,122.8765 C817.8957,104.1522 765.8711,75.0595 742.3225,61.8909 " fill="none" id="Compute next action-&gt;#24" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="737.7467,59.332,743.6495,67.2159,742.1107,61.7724,747.5542,60.2336,737.7467,59.332" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="42" x="676.1981" y="85.3756">ACTION</text><!--MD5=[01c99d74f5be3f1b21943d772f79d7d1]
link #24 to Forward to User Agent--><path d="M723.8242,61.3023 C716.0526,69.2762 702.3484,83.4807 691,96 C656.2533,134.3317 617.1067,180.296 594.9112,206.6298 " fill="none" id="#24-&gt;Forward to User Agent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="591.4978,210.6835,600.3546,206.3757,594.7184,206.8589,594.2352,201.2227,591.4978,210.6835" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="692" y="144.2104">DONE</text><!--MD5=[cefab436a0d182190f7cd062d0fd43b5]
link #24 to Drain session--><path d="M730,67.165 C730,95.9742 730,168.7145 730,205.6864 " fill="none" id="#24-&gt;Drain session" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="730,210.8722,734,201.8722,730,205.8722,726,201.8722,730,210.8722" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="35" x="731" y="144.2104">RETRY</text><!--MD5=[a6b388a97b9971d2aa8059c4f4dd6ba9]
link Drain session to Connect upstream--><path d="M782.6741,213.7401 C786.5004,212.7867 790.3057,211.8634 794,211 C911.8924,183.447 942.5171,181.8915 1061,157 C1062.6276,156.6581 1064.274,156.3108 1065.9339,155.9595 " fill="none" id="Drain session-&gt;Connect upstream" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1070.9486,154.8948,1061.314,152.8514,1066.0577,155.9334,1062.9757,160.677,1070.9486,154.8948" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="960" y="188.2104">finish()</text><!--MD5=[7e390a1c165e6ef223b802e627b67770]
link Forward to User Agent to Destruct--><path d="M657.8713,212.8643 C661.2929,212.2327 664.6803,211.6091 668,211 C717.3046,201.9529 729.8908,201.0539 779,191 C806.2508,185.4211 812.6893,182.2779 840,177 C896.1021,166.1581 911.6594,171.2269 967,157 C968.5967,156.5895 970.2153,156.1463 971.8438,155.6775 " fill="none" id="Forward to User Agent-&gt;Destruct" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="976.7466,154.2015,966.9755,152.9661,971.9589,155.643,969.282,160.6264,976.7466,154.2015" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="39" x="841" y="188.2104">finish()</text><!--MD5=[580a275e94f6b58889eb5ba3ebd76d7d]
link Destruct to end--><path d="M1000.0159,122.9584 C991.4379,113.6113 979.6879,102.6113 967,96 C906.1454,64.2907 822.4372,57.1041 788.362,55.4763 " fill="none" id="Destruct-&gt;end" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="783.3304,55.2599,792.1501,59.6432,788.3258,55.4749,792.4941,51.6506,783.3304,55.2599" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[c464bb995ad29a9eb63e840261bfe77c]
@startuml
partition HttpSM {
   (*) - -> "Determine strategy tag"
}

partition Strategy {
   "Determine strategy tag" - -> "Create strategizer instance"
   "Create strategizer instance" -u-> "Connect upstream"
   "Connect upstream" - -> "Event: SESSION_READY"
}

partition HttpSM {
   "Event: SESSION_READY" -l->  if "send request" then
      - ->[net error] ===RESULT===
   else
      - ->[success] "Read Response Header"
      -> ===RESULT===
   endif
}

partition Strategy {
   - -> "Compute next action"
}

partition HttpSM {
   if "ACTION" then
      - ->[DONE] "Forward to User Agent"
   else
      - ->[RETRY] "Drain session"
   endif
}

partition Strategy {
   "Drain session" - ->[finish()] "Connect upstream"
   "Forward to User Agent" -down->[finish()] "Destruct"
}

partition HttpSM {
   "Destruct" - -> (*)
}

@enduml

PlantUML version 1.2019.11(Sun Sep 22 05:02:15 CDT 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_222-b10
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>