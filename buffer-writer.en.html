
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Buffer Writer &#8212; AMC Traffic Server Documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '8.0.x',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TSConfig / Lua" href="tsconfig-lua.en.html" />
    <link rel="prev" title="Traffic Server Projects" href="ats-projects.en.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tsconfig-lua.en.html" title="TSConfig / Lua"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ats-projects.en.html" title="Traffic Server Projects"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SWOC Docs</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ats-projects.en.html" accesskey="U">Traffic Server Projects</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/balcora-gate-400x400.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Buffer Writer</a><ul>
<li><a class="reference internal" href="#issues">Issues</a></li>
<li><a class="reference internal" href="#reference">Reference</a></li>
<li><a class="reference internal" href="#futures">Futures</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ats-projects.en.html"
                        title="previous chapter">Traffic Server Projects</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="tsconfig-lua.en.html"
                        title="next chapter">TSConfig / Lua</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/buffer-writer.en.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="buffer-writer">
<span id="id1"></span><h1>Buffer Writer<a class="headerlink" href="#buffer-writer" title="Permalink to this headline">Â¶</a></h1>
<p>Buffer writer is a project to improve writting text data to buffers. Currently this is done by code that looks like</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">via_string</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
<span class="o">*</span><span class="n">via_string</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;[&#39;</span><span class="p">;</span>

<span class="c1">// incoming_via can be max MAX_VIA_INDICES+1 long (i.e. around 25 or so)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">txn_conf</span><span class="o">-&gt;</span><span class="n">insert_request_via_string</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Highest verbosity</span>
   <span class="n">via_string</span> <span class="o">+=</span> <span class="n">nstrcpy</span><span class="p">(</span><span class="n">via_string</span><span class="p">,</span> <span class="n">incoming_via</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="n">memcpy</span><span class="p">(</span><span class="n">via_string</span><span class="p">,</span> <span class="n">incoming_via</span> <span class="o">+</span> <span class="n">VIA_CLIENT</span><span class="p">,</span> <span class="n">VIA_SERVER</span> <span class="o">-</span> <span class="n">VIA_CLIENT</span><span class="p">);</span>
   <span class="n">via_string</span> <span class="o">+=</span> <span class="n">VIA_SERVER</span> <span class="o">-</span> <span class="n">VIA_CLIENT</span><span class="p">;</span>
<span class="p">}</span>
<span class="o">*</span><span class="n">via_string</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;]&#39;</span><span class="p">;</span>

<span class="c1">// reserve 4 for &quot; []&quot; and 3 for &quot;])&quot;.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">via_limit</span> <span class="o">-</span> <span class="n">via_string</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="o">-&gt;</span><span class="n">txn_conf</span><span class="o">-&gt;</span><span class="n">insert_request_via_string</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Ultra highest verbosity</span>
   <span class="o">*</span><span class="n">via_string</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
   <span class="o">*</span><span class="n">via_string</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;[&#39;</span><span class="p">;</span>
   <span class="n">via_string</span> <span class="o">+=</span> <span class="n">write_via_protocol_stack</span><span class="p">(</span><span class="n">via_string</span><span class="p">,</span> <span class="n">via_limit</span> <span class="o">-</span> <span class="n">via_string</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span>
   <span class="nb">true</span><span class="p">,</span> <span class="n">proto_buf</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">n_proto</span><span class="p">);</span>
   <span class="o">*</span><span class="n">via_string</span><span class="o">++</span> <span class="o">=</span> <span class="sc">&#39;]&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is ugly, error prone, and unsafe. Most instances of this style just hope there is no buffer overflow. We need to do better.</p>
<p>The idea is to use C++ eleventy features to build a more robust approach. This is based on a family
of classes that control the output buffer and manage the offset tracking. The base is <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> which enables writing to the buffer. Assuming there is an instance of a concrete subclass of <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> named <code class="code docutils literal"><span class="pre">w</span></code> which controls the <em>via_string</em> buffer, the equivalent of the above code would be</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">.</span><span class="n">l</span><span class="p">(</span><span class="s">&quot; [&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">-&gt;</span><span class="n">txn_conf</span><span class="o">-&gt;</span><span class="n">insert_request_via_string</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Highest verbosity</span>
   <span class="n">w</span><span class="p">.</span><span class="n">cstr</span><span class="p">(</span><span class="n">incoming_via</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
   <span class="n">w</span><span class="p">(</span><span class="n">incoming_via</span> <span class="o">+</span> <span class="n">VIA_CLIENT</span><span class="p">,</span> <span class="n">VIA_SERVER</span> <span class="o">-</span> <span class="n">VIA_CLIENT</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">w</span><span class="p">(</span><span class="sc">&#39;]&#39;</span><span class="p">);</span>

<span class="c1">// reserve 4 for &quot; []&quot; and 3 for &quot;])&quot;.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">auxSize</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="n">s</span><span class="o">-&gt;</span><span class="n">txn_conf</span><span class="o">-&gt;</span><span class="n">insert_request_via_string</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Ultra highest verbosity</span>
   <span class="n">w</span><span class="p">.</span><span class="n">l</span><span class="p">(</span><span class="s">&quot; [&quot;</span><span class="p">);</span>
   <span class="n">w</span><span class="p">.</span><span class="n">auxWrite</span><span class="p">(</span><span class="n">write_via_protocol_stack</span><span class="p">(</span>
      <span class="n">w</span><span class="p">.</span><span class="n">auxBuffer</span><span class="p">(),</span> <span class="n">w</span><span class="p">.</span><span class="n">auxSize</span><span class="p">()</span> <span class="o">-</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">true</span><span class="p">,</span> <span class="n">proto_buf</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">n_proto</span><span class="p">));</span>
   <span class="n">w</span><span class="p">.(</span><span class="sc">&#39;]&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">error</span><span class="p">())</span> <span class="n">Warning</span><span class="p">(</span><span class="s">&quot;VIA: static buffer overflow&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>In addition to being shorter and cleaner, the latter is also far more robust in that if the buffer
overflows there will be no memory corruption because <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> will avoid doing the
overflowing writes, and stop output at the last element that fits in the target buffer.</p>
<p>If <code class="code docutils literal"><span class="pre">write_via_protocol_stack</span></code> were changed a bit to have the signature</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="kt">size_t</span> <span class="n">write_via_protocol_stack</span><span class="p">(</span><span class="n">BufferWriter</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">,</span> <span class="kt">bool</span><span class="p">,</span> <span class="n">ts</span><span class="o">::</span><span class="n">StringView</span> <span class="o">*</span> <span class="n">proto</span> <span class="kt">int</span> <span class="n">n_proto</span><span class="p">)</span>
</pre></div>
</div>
<p>then <code class="code docutils literal"><span class="pre">BufferWriter::write</span></code> can be used to further simplify the code for the VIA output to</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">w</span><span class="p">.</span><span class="n">l</span><span class="p">(</span><span class="s">&quot; [&quot;</span><span class="p">)</span>
  <span class="p">.</span><span class="n">reserve</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">write</span><span class="p">(</span><span class="o">&amp;</span><span class="n">write_via_protocol_stack</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="n">proto_buf</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">n_proto</span><span class="p">)</span>
  <span class="p">.</span><span class="n">release</span><span class="p">().</span><span class="n">c</span><span class="p">(</span><span class="sc">&#39;]&#39;</span><span class="p">);</span>
</pre></div>
</div>
<div class="section" id="issues">
<h2>Issues<a class="headerlink" href="#issues" title="Permalink to this headline">Â¶</a></h2>
<p>A remaining issue is how non string data is provided to <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a>. This should be
sufficiently generic that new types can be supported without changing <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a>. It has
been suggested the standard stream operators be overloaded to work with a <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a>,
e.g.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">BufferWriter</span><span class="o">&amp;</span> <span class="k">operator</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">BufferWriter</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">,</span> <span class="n">SomeSpecificType</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">t</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>This can be done independently as <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> provides sufficient functionality to
implement these stream operators if desired.</p>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">Â¶</a></h2>
<dl class="class">
<dt id="_CPPv212BufferWriter">
<span id="BufferWriter"></span><em class="property">class </em><code class="descclassname"></code><code class="descname">BufferWriter</code><a class="headerlink" href="#_CPPv212BufferWriter" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p><a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> is the abstract base class which defines the basic client interface. This
is intended to be the reference type used when passing concrete instances rather than having to
support the distinct types.</p>
<dl class="function">
<dt id="_CPPv2I_6size_tEN12BufferWriter1lERAN_Kc">
template&lt;<a class="reference internal" href="external-types.en.html#_CPPv26size_t" title="size_t">size_t</a> <code class="descclassname"></code><code class="descname">N</code>&gt;<br /><a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a> &amp;<code class="descclassname"></code><code class="descname">l</code><span class="sig-paren">(</span><em class="property">const</em> char (&amp;<em>literal</em>)[N]<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2I_6size_tEN12BufferWriter1lERAN_Kc" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Write <em>literal</em> to the output treating it as a literal string. This will clip the terminating null.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N12BufferWriter4cstrEPKc">
<span id="BufferWriter::cstr__cCP"></span><a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a> &amp;<code class="descclassname"></code><code class="descname">cstr</code><span class="sig-paren">(</span><em class="property">const</em> char *<em>str</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12BufferWriter4cstrEPKc" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Write <em>str</em> to the output treating it as a C-string (null terminated). This will call
<code class="code docutils literal"><span class="pre">strlen</span></code> on <em>str</em> to determine the length.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N12BufferWriter5writeENSt8functionIF6size_tR12BufferWriterzEEEz">
<a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a> &amp;<code class="descclassname"></code><code class="descname">write</code><span class="sig-paren">(</span><a class="reference internal" href="external-types.en.html#_CPPv2St" title="std">std</a>::<a class="reference internal" href="external-types.en.html#_CPPv2I0ENSt8functionE" title="std::function">function</a>&lt;<a class="reference internal" href="external-types.en.html#_CPPv26size_t" title="size_t">size_t</a><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a>&amp;, ...<span class="sig-paren">)</span>&gt; <em>f</em>, ..., <span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12BufferWriter5writeENSt8functionIF6size_tR12BufferWriterzEEEz" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Create a nested <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> that operates on the empty part of the current buffer.
The function <em>f</em> is called and passed the nested <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> and the argument
pack passed to this method.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N12BufferWriter7reserveE6size_t">
<span id="BufferWriter::reserve__s"></span><a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a> &amp;<code class="descclassname"></code><code class="descname">reserve</code><span class="sig-paren">(</span><a class="reference internal" href="external-types.en.html#_CPPv26size_t" title="size_t">size_t</a> <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12BufferWriter7reserveE6size_t" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Restrict the buffer to be <em>n</em> characters less than it is currently. This effectively reserves <em>n</em> characters at the end of the buffer.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N12BufferWriter7releaseEv">
<span id="BufferWriter::release"></span><a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a> &amp;<code class="descclassname"></code><code class="descname">release</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12BufferWriter7releaseEv" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Release all reserved space.</p>
</dd></dl>

<dl class="function">
<dt id="_CPPv2N12BufferWriter7releaseE6size_t">
<span id="BufferWriter::release__s"></span><a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a> &amp;<code class="descclassname"></code><code class="descname">release</code><span class="sig-paren">(</span><a class="reference internal" href="external-types.en.html#_CPPv26size_t" title="size_t">size_t</a> <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N12BufferWriter7releaseE6size_t" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Release <em>n</em> characters of space. The released space is always adjacent to the available buffer.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="_CPPv217FixedBufferWriter">
<span id="FixedBufferWriter"></span><em class="property">class </em><code class="descclassname"></code><code class="descname">FixedBufferWriter</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a><a class="headerlink" href="#_CPPv217FixedBufferWriter" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>This is a class that implements <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> on a fixed buffer.</p>
<dl class="function">
<dt id="_CPPv2N17FixedBufferWriter17FixedBufferWriterEPv6size_t">
<span id="FixedBufferWriter::FixedBufferWriter__voidP.s"></span><code class="descclassname"></code><code class="descname">FixedBufferWriter</code><span class="sig-paren">(</span>void *<em>buffer</em>, <a class="reference internal" href="external-types.en.html#_CPPv26size_t" title="size_t">size_t</a> <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv2N17FixedBufferWriter17FixedBufferWriterEPv6size_t" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>Construct an instance that will write to <em>buffer</em> at most <em>length</em> bytes. Individual
items are either written or not - if the item doesnât fit nothing is written and the instance
goes in to an error state the prevents additional output. This is so that if a large item
doesnât fit a following smaller item isnât output out of order.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="_CPPv2I_6size_tE17LocalBufferWriter">
template&lt;<a class="reference internal" href="external-types.en.html#_CPPv26size_t" title="size_t">size_t</a> <code class="descclassname"></code><code class="descname">N</code>&gt;<br /><em class="property">class </em><code class="descclassname"></code><code class="descname">LocalBufferWriter</code> : <em class="property">public</em> <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter">BufferWriter</a><a class="headerlink" href="#_CPPv2I_6size_tE17LocalBufferWriter" title="Permalink to this definition">Â¶</a><br /></dt>
<dd><p>This is a convenience class which is a wrapper on <a class="reference internal" href="#_CPPv217FixedBufferWriter" title="FixedBufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">FixedBufferWriter</span></code></a> which creates a
buffer as a member rather than having an external buffer that is passed to the instance. The
buffer is <em>N</em> bytes long. The point of this is to replace code like this:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="kt">char</span> <span class="n">buff</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
<span class="n">FixedBufferWriter</span> <span class="nf">w</span><span class="p">(</span><span class="n">buff</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buff</span><span class="p">));</span>
</pre></div>
</div>
<p>with:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span></span><span class="n">LocalBufferWriter</span><span class="o">&lt;</span><span class="mi">1024</span><span class="o">&gt;</span> <span class="n">w</span><span class="p">;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="futures">
<h2>Futures<a class="headerlink" href="#futures" title="Permalink to this headline">Â¶</a></h2>
<p>A planned future extension is a variant of <a class="reference internal" href="#_CPPv212BufferWriter" title="BufferWriter"><code class="xref cpp cpp-class docutils literal"><span class="pre">BufferWriter</span></code></a> that operates on a <code class="code docutils literal"><span class="pre">MIOBuffer</span></code>. This would be very useful in many places that work with <code class="code docutils literal"><span class="pre">MIOBuffer</span></code> instances, most specifically in the body factory logic.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="tsconfig-lua.en.html" title="TSConfig / Lua"
             >next</a> |</li>
        <li class="right" >
          <a href="ats-projects.en.html" title="Traffic Server Projects"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">SWOC Docs</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="ats-projects.en.html" >Traffic Server Projects</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, amc@apache.org.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>